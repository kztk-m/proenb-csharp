<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
        <title>第0回 環境構築1（C#/F#共通） - 東北大学プログラミング演習B (C#)</title>
        <link rel="stylesheet" href="./css/cs.css">
        <script type="text/javascript" src="./js/preprocess.js"></script>
    </head>
    <body>
        <header>
                      <nav>
              <ul>
                <li class="top"><a href="./">ホーム</a></li>
                <!-- <li><a href="./setup.html">環境構築1</a></li> -->
                <!-- <li><a href="./setup_gui.html">環境構築2</a></li> -->
                <li class="dd"><span class="ddt">環境構築</span>
                  <ul>
                    <li><a href="./setup.html">環境構築1（C#/F#共通）</a></li>
                    <li><a href="./setup_gui.html">環境構築2（C#演習用）</a></li>
                    <li><a href="./setup_q.html">確認用課題</a></li>
                  </ul>
                </li>
                <li class="dd"><span class="ddt">講義資料</span>
                  <ul> 
                    <li><a href="./w1.html">第1回資料</a><a href="./q1.html">第1回課題</a></li>
                    <li><a href="./w2.html">第2回資料</a><a href="./q2.html">第2回課題</a></li>
                    <li><a href="./w3.html">第3回資料</a><a href="./q3.html">第3回課題</a></li>
                    <li><a href="./w4.html">第4回資料</a><a href="./q4.html">第4回課題</a></li>
                    <li><a href="./w5.html">第5回資料</a><a href="./q5.html">第5回課題</a></li>
                    <li><a href="./w6.html">第6回資料</a><a href="./q6.html">第6回課題</a></li>
                  </ul>
                </li>
                <li><a href="./links.html">参考書など</a></li>
             </ul>
            </nav>

            
               <h1>第0回 環境構築1（C#/F#共通）</h1>
             
            
               <p class="last-update">最終更新: 2023-04-03 11:14:22</p> 
            
            <div class="qnav">
              <ul>
                <li><a href="setup.html">環境設定1</a></li><li><a href="setup_gui.html">環境設定2</a></li><li><a href="setup_q.html">課題</a></li>
              </ul>
            </div>   
        </header>

        <main role="main" class="with-right-nav">
            <div class="toc">
<ul>
<li><a href="#visual-studioのインストール">Visual Studioのインストール</a>
<ul>
<li><a href="#windows編">Windows編</a></li>
<li><a href="#mac編">Mac編</a></li>
</ul></li>
<li><a href="#net-sdkのインストール-windowsmac-ほぼ共通">.NET SDKのインストール （Windows/Mac ほぼ共通）</a></li>
</ul>
</div>
<p>以下の二つの方法を紹介する．</p>
<ul>
<li>Microsoft Visual Studioを用いる（<a href="#windows編">Windows編</a>/<a href="#mac編">Mac編</a>． 初心者向け）</li>
<li><a href="#net-sdkのインストール-windowsmac-ほぼ共通">.NET SDKのインストール （Windows/Mac ほぼ共通）</a>をしてコマンドラインインターフェースにて演習を進める（中級者向け）</li>
</ul>
<p>後者は，仮想端末での作業に抵抗がなくかつ好みのエディタ（VSCode，Emacs，Viクローン等）を使用したい人にはおススメである．本ページではLinuxにおける環境の構築法については述べない．</p>
<p>なお，このページで紹介している方法ではF#演習のための環境構築にもなっている．
C#演習の第5週・第6週目の課題を進めるには<a href="./setup_gui.html">さらなる準備（別ページ）</a>が必要である（こちらはC#演習分のみ）．</p>
<p>（本ページに掲載されているスクリーンショットは，マイクロソフトの許諾を得て使用しています．）</p>
<div class="caution">
<div class="title">
<p>Caution</p>
</div>
<p>.NET 5 は 2022年5月8日にサポートが終了する予定である．それ以降は，.NET 6をサポートしない Visual Studio 2019 を始め，使用にリスクが生じる．C#演習の第5週・第6週目の課題を進めるために必要な Eto.Forms が Visual Studio 2022 および .NET 6
に対応したら，Visual Studio 2019等ではなく，Visual Studio 2022を利用するようにすることを勧める．</p>
</div>
<h2 id="visual-studioのインストール">Visual Studioのインストール</h2>
<h3 id="windows編">Windows編</h3>
<p><strong>インストール中はネットワーク接続が必要なことに注意する．</strong></p>
<ol>
<li><a href="https://visualstudio.microsoft.com/ja/">Visual Studio 2022のページ</a>において「Visual Studioのダウンロード」にマウスポインタを合わせるといくつかの項目が表示される．その中の「Community 2022」を選択し，Visual Studio Community 2022をダウンロードする．</li>
</ol>
<blockquote>
<p>すると <code>VisualStudioSetup.exe</code> というファイルがダウンロードされる．</p>
</blockquote>
<ol>
<li><p>ダウンロードしたファイルを実行する．「続行」を押す前にライセンス条項には目を通しておこう．</p>
<ol>
<li>途中でインストールする項目が聞かれるので，「ワークロード」タブにある<em>「.NETデスクトップ開発」</em>をチェックし，その「インストール詳細」から
<em>「F# デスクトップ言語のサポート」</em>にもチェックを入れる．7.8 GB弱のディスク容量が必要となる．</li>
</ol>
<p><img src="images/ss_vs2022_win_installer.png" alt="image" /></p></li>
<li><p>「インストール」ボタンを押してインストールを完了させる．2.2 GBほどのダウンロードが生じるので高速なネット回線が利用可能なところで行おう．</p></li>
<li><p>起動時にいろいろ聞かれるが適当に答えたのでよい（サインインのアカウントも好きなものでよいし，設定しなくてもよい）．インストールが終了すると自動的にVisual Studio Community 2022が起動され，以下の画面が表示される．インストーラのウィンドウのほうは閉じてOK．</p>
<p><img src="images/ss_vs2022_win_startup.png" alt="image" /></p></li>
<li><p>動作確認もしておこう．</p>
<ol type="i">
<li><p>上記で「新しいプロジェクトの作成」を選ぶ．</p></li>
<li><p>テンプレート選択画面で，C#の「コンソール アプリケーション」を選ぶ．</p>
<p><img src="images/ss_vs2022_win_template_selection.png" alt="image" /></p></li>
<li><p>プロジェクト名とソリューション名を聞かれるので適当に入力する．たとえば，どちらも <code>HelloWorldCS</code> にしたのでよい（<code>CS</code>はC#の気持ち）．</p>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>プロジェクトは一つの実行形式やライブラリを作成するためのコード等を全てまとめたものであり，ソリューションは関連するプロジェクトをまとめたもの（参考：<a href="https://docs.microsoft.com/en-us/visualstudio/ide/solutions-and-projects-in-visual-studio?view=vs-2022">What are solutions and projects in Visual Studio?</a>）．あえて英語版にリンクしたのは，日本語版だと"a project contains all files that are compiled into an executable, library, or website"の"a"や"an"がうまく訳出されていないように感じたため．</p>
</div>
<p><img src="images/ss_vs2022_win_creating_project.png" alt="image" /></p></li>
<li><p>フレームワークを選んで「作成」する．ここではデフォルトのままでよい．</p>
<p><img src="images/ss_vs2022_win_fw_selection.png" alt="image" /></p></li>
<li><p>エディタで <code>Program.cs</code> が開かれた状態になる．</p>
<p><img src="images/ss_vs2022_win_editor.png" alt="image" /></p></li>
<li><p>コードを実行するには上のツールバーの真ん中あたりにある「▶ HelloWorldCS」と書かれたボタンを押す．すると，ビルドが行われ実行形式が作成された後にその実行形式が実行される．ビルド時の出力等が表示された後に，「Microsoft Visual Studio デバッグコンソール」に <code>Hello, World!</code> と表示されればOK．</p>
<p><img src="images/ss_vs2022_win_output.png" alt="image" /></p></li>
<li><p>F#でも同様であることを確認しておこう（新しいプロジェクトを作成する際のテンプレートを選ぶ場面で，「すべての言語」を「F#」に変更し，「コンソール アプリケーション」を選べばよい）．</p>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>もし以上のとおりやった上でF#でのビルドに失敗し，「パッケージ FSharp.Core が見つかりません。ソース Microsoft Visual Studio Offline Packages には、この ID のパッケージが存在しません。」というエラーメッセージが出る場合は，コマンドライン（WindowsだとPowerShellか「コマンド プロンプト」を利用）から</p>
<pre><code>dotnet nuget add source https://api.nuget.org/v3/index.json -n nuget.org</code></pre>
<p>を実行する．あるいは，以下の「<a href="#net-sdkのインストール-windowsmac-ほぼ共通">.NET SDKのインストール （Windows/Mac ほぼ共通）</a>」の手順1～4を読みSDKをインストールするとよい．（それでも直らなければ，教員・TAに質問をしてください．）</p>
</div></li>
</ol></li>
</ol>
<h3 id="mac編">Mac編</h3>
<p><strong>インストール中はネットワーク接続が必要なことに注意する．</strong></p>
<ol>
<li><p><a href="https://visualstudio.microsoft.com/ja/">Visual Studio 2022のページ</a>より「Visual Studio for Macをダウンロード」をたどり，Visual Studio 2022 for Macをダウンロードする．</p>
<p>すると <code>visualstudioformacpreviewinstaller-17.5.0.124.dmg</code>みたいな名前のファイルがダウンロードされる（数字の部分はダウンロードするタイミングによって違うかもしれない）．</p></li>
<li><p>Dock上の「ダウンロード」から上のファイルをクリックする（あるいはFinderでダブルクリックすると），どでかいアイコンが表示されたウィンドウが表示されるので，アイコンをダブルクリックしてインストールを開始する．</p></li>
<li><p>「“Install Visual Studio for Mac.app”はインターネットからダウンロードされたアプリケーションです。開いてもよろしいですか?」と聞かれるので，「開く」．</p></li>
</ol>
<blockquote>
<ol>
<li>すると「ダウンロード」以下のファイルにアクセスしてよいか聞かれるが，許可する．</li>
<li>その後「Visual Studio for Mac をダウンロードしていただき、ありがとうございます」と書かれた画面が表示される．ライセンス条項を確認し問題なければ「続行」を選んでインストールを続ける．</li>
</ol>
</blockquote>
<ol>
<li><p>「何をインストールしますか？」と聞かれる．「.NET」だけ選べば十分．</p></li>
<li><p>あとは，画面に従ってインストールを完了させる（数十分ほど時間がかかるかもしれない）．また，何度かパスワードが聞かれる．</p>
<p><img src="images/ss_vs2022_mac_installer.png" alt="image" /></p></li>
<li><p>上で「完了時にVisual Studio Previewを開く」をチェックしていたら（なにもしていなければそうなっているはず），インストールが終了すると自動的にVisual Studio 2022 for Macが起動される．起動時にいろいろ聞かれるが適当に答えたのでよい（サインインのアカウントも好きなものでよいし，設定しなくてもよい）．最終的に「Visual Studio 2022 for Mac」と書かれたウィンドウが表示される．</p></li>
</ol>
<blockquote>
<p><img src="images/ss_vs2022_mac_start.png" alt="image" /></p>
</blockquote>
<ol>
<li><p>動作確認もしておこう．</p>
<ol type="i">
<li><p>上記のウィンドウ（一旦Visual Studioを閉じても，また起動すれば上記が表示される）で「新規」を選択する．</p></li>
<li><p>テンプレート選択画面で「コンソールアプリケーション」を選ぶ．</p>
<p><img src="images/ss_vs2022_mac_template_selection.png" alt="image" /></p>
<ul>
<li>C#/F#の部分は使用する言語を選ぶ．両方の言語について動作確認しよう．</li>
</ul></li>
<li><p>ターゲットフレームワークを聞かれるので適当に選ぶ．</p>
<p><img src="images/ss_vs2022_mac_fw_selection.png" alt="image" /></p></li>
</ol>
<blockquote>

</blockquote>
<ol>
<li><p>プロジェクト名とソリューション名を聞かれるので適当に入力する．たとえば，どちらも <code>HelloWorldCS</code> にしたのでよい（<code>CS</code>はC#の気持ち）．</p>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>プロジェクトは一つの実行形式やライブラリを作成するためのコード等を全てまとめたものであり，ソリューションは関連するプロジェクトをまとめたもの（参考：<a href="https://docs.microsoft.com/en-us/visualstudio/ide/solutions-and-projects-in-visual-studio?view=vs-2022">What are solutions and projects in Visual Studio?</a>）．</p>
</div>
<p><img src="images/ss_vs2022_mac_creating_project.png" alt="image" /></p></li>
<li><p>エディタで <code>Program.cs</code> が開かれた状態になる．</p>
<p><img src="images/ss_vs2022_mac_editor.png" alt="image" /></p></li>
<li><p>コードを実行するには左上のほうにある▶ボタンを押す．すると，ビルドが行われ実行形式が作成された後にその実行形式が実行される．ビルド時の出力等がされた後に以下のように「Terminal」/「ターミナル」に <code>Hello, World!</code> と表示されればOK．</p>
<p><img src="images/ss_vs2022_mac_output.png" alt="image" /></p>
<ul>
<li>右下の「ターミナル - HelloWorldCS」（<code>HelloWorldCS</code>の部分は具体的なプロジェクト名に置き換える）の上にマウスカーソルを合わせる必要があるかもしれない．いちいちマウスオーバーするのが面倒臭いのであれば右上の📌の形のボタンを押して（あるいは，ドロップダウンメニューから「ドッキング」を選択して）位置を固定しておくとよい．
<ul>
<li>元のマウスオーバすると「枠」がポップアップする設定に戻すには📌を再び押すか，ドロップダウンメニューから「自動的に隠す」（「ドッキング解除」ではない）を選択する．</li>
</ul></li>
</ul></li>
<li><p>上記の動作確認はC#/F#の両方について行おう．</p></li>
</ol>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>もし以上のとおりやった上でF#でのビルドに失敗し，「パッケージ FSharp.Core が見つかりません。ソース Microsoft Visual Studio Offline Packages には、この ID のパッケージが存在しません。」というエラーメッセージが出る場合は，コマンドライン（MacだとTerminal.app）から</p>
<pre><code>dotnet nuget add source https://api.nuget.org/v3/index.json -n nuget.org</code></pre>
<p>を実行する．あるいは，以下の「<a href="#net-sdkのインストール-windowsmac-ほぼ共通">.NET SDKのインストール （Windows/Mac ほぼ共通）</a>」の手順1～4を読みSDKをインストールするとよい．（それでも直らなければ，教員・TAに質問をしてください．）</p>
</div></li>
</ol>
<h2 id="net-sdkのインストール-windowsmac-ほぼ共通">.NET SDKのインストール （Windows/Mac ほぼ共通）</h2>
<p>Visual Studioに含まれているので，上記を行っている場合は以下を行う必要はない．</p>
<ol type="1">
<li><p><a href="https://dotnet.microsoft.com/ja-jp/download">.NET SDKのダウンロードページ</a>より，software development kit (SDK)をダウンロードする．</p>
<ul>
<li>Windowsの人はWindows版のSDKをダウンロードする．</li>
<li>Mac版についてはいわゆるintel MacとM1 Macではダウンロードすべきものが違うので注意．前者はx64版を後者はArm64版をダウンロードしよう．</li>
</ul></li>
<li><p>ダウンロードしたインストーラを実行し，指示に従ってインストールを完了する．</p>
<ul>
<li>Windows版なら<code>dotnet-sdk-6.0.407-win-x64.exe</code>みたいな名前</li>
<li>Macのx64版なら<code>dotnet-sdk-6.0.407-osx-x64.pkg</code> みたいな名前</li>
</ul></li>
<li><p>ターミナル（WindowsだとPowerShellか「コマンド プロンプト」，MacだとTerminal.appやiTerm.app）を開き，以下を実行する．</p>
<pre class><code>dotnet --list-sdks</code></pre>
<p>以下は私の環境における出力だが，このようにダウンロードしたSDK（6.0.XXX）が表示されたらばOK．</p>
<pre class><code>6.0.400 [/usr/local/share/dotnet/sdk]
6.0.407 [/usr/local/share/dotnet/sdk]
7.0.202 [/usr/local/share/dotnet/sdk]</code></pre></li>
<li><p>動作確認もしておこう．</p>
<ol type="i">
<li><p>適当なディレクトリに移動して以下を実行する．</p>
<pre class><code>dotnet new console -o HelloWorldCS </code></pre></li>
<li><p><code>HelloWorldCS</code> というディレクトリができているので，そこに移動する．</p>
<pre class><code>cd HelloWorldCS </code></pre>
<p>中身を<code>ls</code>で確認してみよう．たとえば，Macだと以下のように表示される（Windowsだと <code>ls</code> は <code>dir</code> の別名なので，表示は多少異なる）．</p>
<pre class><code>HelloWorldCS.csproj  Program.cs           obj/</code></pre>
<p>プログラムを書くには， <code>Program.cs</code> を変更すればよい．現時点では <code>Program.cs</code> の中身は以下の通りである．</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cs"><code class="sourceCode cs"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">// See https://aka.ms/new-console-template for more information</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Console<span class="op">.</span><span class="fu">WriteLine</span><span class="op">(</span><span class="st">&quot;Hello, World!&quot;</span><span class="op">);</span></span></code></pre></div></li>
<li><p>以下をを実行してビルドする．</p>
<pre class><code>dotnet build</code></pre></li>
<li><p>以下を実行してビルドしたプログラムを実行する．</p>
<pre class><code>dotnet run </code></pre>
<p>すると，"Hello, World!"が表示されるのが確認できるはずだ．</p></li>
<li><p>F#でも同様であることを確認しておこう（<code>dotnet new</code>を実行する場面で，<code>dotnet new console -o HelloWorldCS</code> の代わりに <code>dotnet new console -lang "F#" -o HelloWorldFS</code> とする．また，このコマンドだと<code>HelloWorldCS</code>ではなく<code>HelloWorldFS</code>というディレクトリが作成される）</p></li>
</ol></li>
</ol>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
